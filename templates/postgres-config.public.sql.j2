-- create user and assign it to dedicated db
CREATE ROLE dbuser WITH ENCRYPTED PASSWORD '{{ db.password }}';
CREATE DATABASE {{ db.name }};
GRANT ALL PRIVILEGES ON DATABASE {{ db.name }} TO {{ db.user }};

-- connect to db
\c {{ db.name }}

-- give user access to {{ db.name }}.public schema
GRANT ALL PRIVILEGES ON SCHEMA public TO {{ db.user }};
-- allow user to use sequence functions in {{ db.name }}.public schema
GRANT USAGE ON ALL SEQUENCES IN SCHEMA public TO {{ db.user }};